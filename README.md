Агент для отбора гипотез и составления по ним вопросов

data_json - все карточки с названием, гипотезам и возможным действиям

bot.py - код для телеграм бота

giga.py - основная логика, сначала отбор гипотезы, потом составление вопроса

explanations_633513682.json - логи отбора карточек

Как работает в боте: Мы отправляем ему страт диалог, он возвращает вопросы для км.

Как все работает в коде: Мы отправляем страт диалог и название карточки, если гигачат говорит, что такая карточка акутальна мы придумываем к ней вопросы, если нет забываем про нее. Карточки выводятся в тг бот, где есть возможность для км подтвердить, что карточка полезна.

UPD:
Раньше анализировали все гипотезы(cards_ru_all.json) теперь решили несколько(оставил их в cards_ru_part.json), обращение в utils/cards.py

Также поменял промпт для отбора карточек

Было:

def build_relevance_prompt(card_title: str, dialog_text: str) -> str:
    return f"""Ты — аналитик. Скажи, относится ли тема \"{card_title}\" к следующему бизнес-контексту (страт-диалогу). Ответь только "да" или "нет" и поясни почему.

Контекст:
\"\"\"
{dialog_text}
\"\"\"
"""

Стало:

def build_relevance_prompt(card_title: str, dialog_text: str) -> str:
    return f"""Ты — опытный бизнес-аналитик. Проанализируй, относится ли тема \"{card_title}\" к приведённому бизнес-контексту.

Контекст включает:
— Стратегический диалог с клиентом
— Финансовые показатели компании (например: прибыль, выручка, рентабельность, издержки)
— Описание проблем, целей, планов и внешней среды компании

Инструкция:
Определи, действительно ли тема гипотезы напрямую связана с ситуацией в контексте. Учитывай как смысл, так и конкретные данные — особенно финансовые. Не соглашайся, если связь лишь косвенная. Важна точная релевантность.

Ответь строго:
- Сначала «да» или «нет» (с маленькой буквы)
- Затем кратко поясни, почему

Контекст:
\"\"\"
{dialog_text}
\"\"\"
"""

Бота не хостил, запускается python bot.py

Токен бота и гигачата скинул в телеге

2025-14-08